name: å‘å¸ƒç‰ˆæœ¬
run-name: æ­£åœ¨å‘å¸ƒæ–°ç‰ˆæœ¬ğŸš€

on:
  push:
    branches:
      - release        # åŒ¹é…ä¸»å‘å¸ƒåˆ†æ”¯
      - test-*         # åŒ¹é…æ‰€æœ‰ test- å¼€å¤´çš„åˆ†æ”¯ï¼ˆé€šé…ç¬¦ï¼‰

jobs:
  # å…¬å…±æ­¥éª¤ï¼ˆæ‰€æœ‰åˆ†æ”¯éƒ½éœ€è¦æ‰§è¡Œçš„å‰ç½®æ“ä½œï¼‰
  common-steps:
    runs-on: ubuntu-latest
    outputs:
      modpack_name: ${{ steps.read-modpackname.outputs.value }}
      modpack_ver: ${{ steps.generate_modpack_version.outputs.VERSION }}
      mc_version: ${{ steps.read-minecraft.outputs.value }}
      forge_version: ${{ steps.read-forge.outputs.value }}
    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v4
        with:
          fetch-depth: 1 # åªå–æœ€æ–°æäº¤ï¼ŒåŠ é€Ÿ
      - name: è¯»å–æ•´åˆåŒ…å
        uses: SebRollen/toml-action@v1.2.0
        id: read-modpackname
        with:
          file: ${{ github.workspace }}/pack.toml
          field: 'name'
      - name: è¯»å–æ•´åˆåŒ…ç‰ˆæœ¬å·
        uses: SebRollen/toml-action@v1.2.0
        id: read-version
        with:
          file: ${{ github.workspace }}/pack.toml
          field: 'version'
      - name: è¯»å–mcç‰ˆæœ¬å·
        uses: SebRollen/toml-action@v1.2.0
        id: read-minecraft
        with:
          file: ${{ github.workspace }}/pack.toml
          field: 'versions.minecraft'
      - name: è¯»å–forgeç‰ˆæœ¬å·
        uses: SebRollen/toml-action@v1.2.0
        id: read-forge
        with:
          file: ${{ github.workspace }}/pack.toml
          field: 'versions.forge'
      - name: ç”Ÿæˆæ•´åˆåŒ…å¸¦æµ‹è¯•åç¼€ç‰ˆæœ¬å·
        id: generate_modpack_version
        run: |
          BRANCH_NAME="${{ github.ref_name }}"
          if [[ "$BRANCH_NAME" == *test* ]]; then
            VERSION="${{ steps.read-version.outputs.value }}-test-build-${{ github.run_number }}"
            echo "VERSION=$VERSION" >> $GITHUB_OUTPUT
          else
            VERSION="${{ steps.read-version.outputs.value }}"
            echo "VERSION=$VERSION" >> $GITHUB_OUTPUT
          fi
      - name: è¾“å‡ºè¯»å–çš„å˜é‡ç”¨ä½œéªŒè¯
        run: |
          echo "Modpack Name: ${{ steps.read-modpackname.outputs.value }}"
          echo "Modpack Version: ${{ steps.read-version.outputs.value }}"
          echo "Modpack Full Version: ${{ steps.generate_modpack_version.outputs.VERSION }}"
          echo "Minecraft Version: ${{ steps.read-minecraft.outputs.value }}"
          echo "Forge Version: ${{ steps.read-forge.outputs.value }}"

  # å®¢æˆ·ç«¯ç›¸å…³ä»»åŠ¡ï¼ˆå¹¶è¡Œæ‰§è¡Œï¼‰
  client-tasks:
    needs: common-steps       # ä¾èµ–å…¬å…±æ­¥éª¤å®Œæˆ
    runs-on: ubuntu-latest
    env:  # Job çº§ç¯å¢ƒå˜é‡ï¼ˆç®€åŒ–è¯»å–å˜é‡ï¼‰
      MODPACK_NAME: ${{ needs.common-steps.outputs.modpack_name }}
      MODPACK_VERSION: ${{ needs.common-steps.outputs.modpack_ver }}
      MC_VERSION: ${{ needs.common-steps.outputs.mc_version }}
      FORGE_VERSION: ${{ needs.common-steps.outputs.forge_version }}
      VERSION_FILE_PATH: ${{ github.workspace }}/config/fancymenu/assets/version.md
      HMCL_DOWNLOAD_URL: https://github.com/HMCL-dev/HMCL/releases/download/release-3.6.12/HMCL-3.6.12.jar
      JAVA_DOWNLOAD_URL: https://download.oracle.com/java/17/archive/jdk-17.0.12_windows-x64_bin.msi
    if: >
      github.ref_name == 'release' || 
      startsWith(github.ref_name, 'test-release') ||
      startsWith(github.ref_name, 'test-client')
    steps:
      - name: æµ‹è¯•ç¯å¢ƒå˜é‡
        run: |
          echo "Modpack Name: $MODPACK_NAME"
          echo "Modpack Version: $MODPACK_VERSION"
          echo "Minecraft Version: $MC_VERSION"
          echo "Forge Version: $FORGE_VERSION"
          echo "Version File Path: $VERSION_FILE_PATH"
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v4
        with:
          fetch-depth: 1 # åªå–æœ€æ–°æäº¤ï¼ŒåŠ é€Ÿ
      - name: å®‰è£… Packwiz æ‰“åŒ…è½¯ä»¶
        id: download-artifact
        uses: actions/download-artifact@v4
        with:
          pattern: "Linux 64-bit x86"
          path: ${{ github.workspace }}
          github-token: ${{ secrets.GITHUB_TOKEN }}
          repository: Jasons-impart/packwiz
          run-id: 14558970721
      - name: æŒªåŠ¨packwizåˆ°æ ¹ç›®å½•
        run: |
          # ls ${{ github.workspace }}/Linux\ 64-bit\ x86
          mv ${{ github.workspace }}/Linux\ 64-bit\ x86/packwiz ./packwiz
          chmod +x ./packwiz
      # - name: é‡å‘½åHMCLé…ç½®å’Œoptions
      #   run: |
      #     mv .hmclversion.cfg hmclversion.cfg
      #     mv .options.txt options.txt
      - name: å†™ç‰ˆæœ¬å·æ–‡ä»¶ä¾›fancymenuå±•ç°åœ¨æ¸¸æˆé¦–é¡µ
        # æ ¼å¼å¦‚ä¸‹ï¼Œä¸ºæ­¤éœ€è¦ç”¨ > è¦†ç›–å†™ç¬¬ä¸€è¡Œï¼Œç”¨ >> è¿½åŠ å†™åç»­è¡Œ
        # |||
        # Create-New-Horizon x.x.x.x xxxx
        # MIT License Copyright (c) 2025 CTNH Production Team
        # |||
        run: |
          echo "|||" > $VERSION_FILE_PATH
          echo "$MODPACK_NAME $MODPACK_VERSION" >> $VERSION_FILE_PATH
          echo "MIT License Copyright (c) 2025 CTNH Team" >> $VERSION_FILE_PATH
          echo "|||" >> $VERSION_FILE_PATH
          cat $VERSION_FILE_PATH
      # - name: æ›´æ–°æ–‡ä»¶ç´¢å¼•
      #   run: |
      #     ./packwiz refresh
      # - name: ç”Ÿæˆå¸¦modæœ¬ä½“çš„åŒ… ç§»åŠ¨åˆ°workspaceæ–‡ä»¶å¤¹
      #   run: |
      #     ./packwiz curseforge export
      #     mkdir ../click_to_run_release
      #     mv *.zip ../click_to_run_release/modpack.zip
      # - name: ä¸‹è½½HMCLå¯åŠ¨å™¨ä¸jdkç¯å¢ƒ
      #   run: |
      #     curl -o HMCL.jar -L $HMCL_DOWNLOAD_URL
      #     curl -o jdk17.msi -L $JAVA_DOWNLOAD_URL
      #     mv HMCL.jar ../click_to_run_release
      #     mv jdk17.msi ../click_to_run_release
      - name: æ£€æµ‹å¹¶ç”Ÿæˆmods metaä¿¡æ¯
        run: |
          ./packwiz curseforge detect
      - name: æ›´æ–°index
        run: |
          ./packwiz refresh
      - name: ç”Ÿæˆä¸å¸¦modæœ¬ä½“çš„åŒ…
        run: |
          ./packwiz curseforge export
          mv *.zip ../lite-release.zip
          unzip ../lite-release.zip -d ../lite-release
          ls ..
      - name: Workaround actions/upload-artifact#176
        run: |
          echo "artifacts_path=$(realpath ..)" >> $GITHUB_ENV
      # - name: ä¸Šä¼ æ‡’äººåŒ…
      #   uses: actions/upload-artifact@v4
      #   with:
      #     name: "[ClickToUse]Client-${{ env.MODPACK_NAME }}-${{ env.MODPACK_VERSION }}"
      #     path: ${{ env.artifacts_path }}/click_to_run_release/
      - name: ä¸Šä¼ ä¸å¸¦modåŒ…
        uses: actions/upload-artifact@v4
        with:
          name: "[Client]${{ env.MODPACK_NAME }}-${{ env.MODPACK_VERSION }}-lite"
          path: ${{ env.artifacts_path }}/lite-release/
      - name: ä¸Šä¼ manifest.jsonç”¨äºå®¢æˆ·ç«¯è¡¥ä¸
        uses: actions/upload-artifact@v4
        with:
          name: "${{ env.MODPACK_NAME }}-${{ env.MODPACK_VERSION }}-manifest"
          path: ${{ env.artifacts_path }}/lite-release/manifest.json

  # æœåŠ¡ç«¯ç›¸å…³ä»»åŠ¡ï¼ˆå¹¶è¡Œæ‰§è¡Œï¼‰
  # server-tasks:
  #   needs: common-steps
  #   runs-on: ubuntu-latest
  #   env:  # Job çº§ç¯å¢ƒå˜é‡ï¼ˆç®€åŒ–è¯»å–å˜é‡ï¼‰
  #     MODPACK_NAME: ${{ needs.common-steps.outputs.modpack_name }}
  #     MODPACK_VERSION: ${{ needs.common-steps.outputs.modpack_ver }}
  #     MC_VERSION: ${{ needs.common-steps.outputs.mc_version }}
  #     FORGE_VERSION: ${{ needs.common-steps.outputs.forge_version }}
  #     FORGE_DOWNLOAD_URL_PREFIX: https://maven.minecraftforge.net/net/minecraftforge/forge
  #   # if: >
  #   #   github.ref_name == 'release' || 
  #   #   startsWith(github.ref_name, 'test-release') ||
  #   #   startsWith(github.ref_name, 'test-server')
  #   steps:
  #     - name: æ£€å‡ºä»£ç 
  #       uses: actions/checkout@v4
  #       with:
  #         fetch-depth: 1 # åªå–æœ€æ–°æäº¤ï¼ŒåŠ é€Ÿ
  #     - name: ä¸‹è½½jaræ–‡ä»¶
  #       run: |
  #         java -jar packwiz-installer-bootstrap.jar ./pack.toml
  #     - name: åˆ é™¤ä¸æœåŠ¡ç«¯æ— å…³çš„æ–‡ä»¶
  #       run: |
  #           # mapfile -t prefixes < ${{ github.workspace }}/.packwizignore
  #           # for prefix in "${prefixes[@]}"; do
  #           #   echo "Deleting files with prefix: $prefix"
  #           #   find ${{ github.workspace }} -name "${prefix}*" -exec rm {} +
  #           # done
  #           rm -rf ${{ github.workspace }}/resourcepacks
  #           rm -rf ${{ github.workspace }}/shaderpacks
  #           rm -f ${{ github.workspace }}/ModList0.4a.md
  #           rm -f ${{ github.workspace }}/README.md
  #           rm -f ${{ github.workspace }}/TODOlist.md
  #           rm -f ${{ github.workspace }}/KubeJSStyleGuide.md
  #           rm -f ${{ github.workspace }}/DevGuide.md
  #           rm -f ${{ github.workspace }}/pack.toml
  #           rm -f ${{ github.workspace }}/index.toml
  #           rm -f ${{ github.workspace }}/client_jvm_args.example.txt

  #     - name: åˆ é™¤å®¢æˆ·ç«¯onlyæ¨¡ç»„
  #       run: |
  #           mapfile -t prefixes < ${{ github.workspace }}/.clientonlymodlist
  #           for prefix in "${prefixes[@]}"; do
  #             echo "Deleting files with prefix: $prefix"
  #             find ${{ github.workspace }}/mods -name "${prefix}*" -exec rm {} +
  #           done
  #     - name: æ ¹æ®pack.tomlçš„æ•´åˆåŒ…ç‰ˆæœ¬æ›¿æ¢æœåŠ¡å®‰è£…è„šæœ¬é…ç½®
  #       env:
  #         MODPACK: ${{ steps.read-version.outputs.value }}
  #       run: |
  #         sed -i "s/^MODPACK_VERSION=.*/MODPACK_VERSION=$MODPACK/" ${{ github.workspace }}/variables.txt
  #         grep '^MODPACK_VERSION=' ${{ github.workspace }}/variables.txt
  #     - name: ä¸‹è½½forgeä¸ServerStarterJar
  #       env:
  #         MINECRAFT: ${{ steps.read-minecraft.outputs.value }}
  #         FORGE: ${{ steps.read-forge.outputs.value }}
  #       run: |
  #         FORGE_URL="$FORGE_DOWNLOAD_URL_PREFIX/$MC_VERSION-$FORGE_VERSION/forge-$MC_VERSION-$FORGE_VERSION-installer.jar"
  #         echo "$FORGE_URL"
  #         curl -L -o "${{ github.workspace }}/forge.jar" "$FORGE_URL"
  #     - name: æœåŠ¡ç«¯å¯åŠ¨batè„šæœ¬æ”¹ä¸ºCRLF
  #       run: |
  #         sudo apt-get install dos2unix
  #         unix2dos ${{ github.workspace }}/start.bat
  #     - name: list remained files & mods
  #       run: |
  #         ls ${{ github.workspace }}
  #         ls ${{ github.workspace }}/mods
  #     - name: ä¸Šä¼ å¸¦modåŒ…
  #       uses: actions/upload-artifact@v4
  #       with:
  #         name: "Server-${{ env.MODPACK_NAME }}-${{ env.MODPACK_VERSION }}"
  #         path: ${{ github.workspace }}
  #     - name: å®‰è£…forge
  #       run: |
  #         cd ${{ github.workspace }} && java -jar forge.jar nogui --installServer
  #     - name: ä¸Šä¼ å¸¦forgeæ ¸å¿ƒçš„åŒ…
  #       uses: actions/upload-artifact@v4
  #       with:
  #         name: "ClickToUse-Server-${{ env.MODPACK_NAME }}-${{ env.MODPACK_VERSION }}"
  #         path: ${{ github.workspace }}

  # è¡¥ä¸ç›¸å…³ä»»åŠ¡ï¼Œä¾èµ–å®¢æˆ·ç«¯ç›¸å…³ä»»åŠ¡çš„manifest.json
  patch-tasks:
    needs: [common-steps, client-tasks]
    runs-on: ubuntu-latest
    env:  # Job çº§ç¯å¢ƒå˜é‡ï¼ˆç®€åŒ–è¯»å–å˜é‡ï¼‰
      MODPACK_NAME: ${{ needs.common-steps.outputs.modpack_name }}
      MODPACK_VERSION: ${{ needs.common-steps.outputs.modpack_ver }}
      MC_VERSION: ${{ needs.common-steps.outputs.mc_version }}
      FORGE_VERSION: ${{ needs.common-steps.outputs.forge_version }}
      VERSION_FILE_RELATIVE_DIR_PATH: config/fancymenu/assets/
    if: >
      github.ref_name == 'release' || 
      startsWith(github.ref_name, 'test-release') ||
      startsWith(github.ref_name, 'test-patch')
    steps:
      - name: æµ‹è¯•ç¯å¢ƒå˜é‡
        run: |
          echo "Modpack Name: $MODPACK_NAME"
          echo "Modpack Version: $MODPACK_VERSION"
          echo "Minecraft Version: $MC_VERSION"
          echo "Forge Version: $FORGE_VERSION"
          echo "Version File Path: $VERSION_FILE_PATH"
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          fetch-tags: true
      - name: å®‰è£… Packwiz æ‰“åŒ…è½¯ä»¶
        id: download-artifact
        uses: actions/download-artifact@v4
        with:
          pattern: "Linux 64-bit x86"
          path: ${{ github.workspace }}
          github-token: ${{ secrets.GITHUB_TOKEN }}
          repository: Jasons-impart/packwiz
          run-id: 14558970721
      - name: æŒªåŠ¨packwizåˆ°æ ¹ç›®å½•
        run: |
          # ls ${{ github.workspace }}/Linux\ 64-bit\ x86
          mv ${{ github.workspace }}/Linux\ 64-bit\ x86/packwiz ./packwiz
          chmod +x ./packwiz
      - name: è·å–æœ€è¿‘çš„tagå¹¶é…ç½®ç¯å¢ƒå˜é‡
        run: |
          # è·å–å½“å‰ commit çš„ hash
          current_commit=$(git rev-parse HEAD)
          # è·å–å½“å‰ commit å…³è”çš„ tag
          current_commit_tags=$(git tag --points-at $current_commit)
          if [ -z "$current_commit_tags" ]; then
            # å½“å‰ commit æ²¡æœ‰å…³è” tagï¼Œç›´æ¥å–æœ€æ–° tag
            latest_tag=$(git tag --sort=-creatordate | head -n 1)
          else
            # å½“å‰ commit æœ‰å…³è” tagï¼Œè¿‡æ»¤æ‰è¿™äº› tag åå–æœ€æ–° tag
            latest_tag=$(git tag --sort=-creatordate | grep -v "$current_commit_tags" | head -n 1)
          fi
          if [ -z "$latest_tag" ]; then
            echo "No suitable tag found. Exiting."
            exit 1
          fi
          echo "æœ€è¿‘çš„tagæ˜¯: $latest_tag"
          echo "LATEST_TAG=$latest_tag" >> $GITHUB_ENV
      - name: å‡†å¤‡è¡¥ä¸æ–‡ä»¶
        run: |
          # ç”Ÿæˆå®Œæ•´å·®å¼‚æŠ¥å‘Š
          git diff --name-status ${{ env.LATEST_TAG }} HEAD > diff_report.txt
          cat diff_report.txt
          
          # è§£æå·®å¼‚æŠ¥å‘Š
          grep -E '^D' diff_report.txt | cut -f2 > deleted_files.txt
          grep -E '^R' diff_report.txt | cut -f2 >> deleted_files.txt
          grep -E '^[A|M]' diff_report.txt | cut -f2 > added_files.txt
          grep -E '^R' diff_report.txt | cut -f3 >> added_files.txt
          grep -E '^C' diff_report.txt | cut -f3 >> added_files.txt

          # åˆ›å»ºè¡¥ä¸ç›®å½•
          mkdir -p patch

          # å¤åˆ¶æ–°å¢/ä¿®æ”¹æ–‡ä»¶
          while IFS= read -r file; do
            mkdir -p "patch/$(dirname "$file")"
            cp "$file" "patch/$file"
          done < added_files.txt

          # ç§»é™¤å®¢æˆ·ç«¯onlyçš„mod
          mapfile -t prefixes < .clientonlymodlist
          for prefix in "${prefixes[@]}"; do
            echo "Deleting files with prefix: $prefix"
            if [ -d "patch/mods" ]; then
              find patch/mods -name "${prefix}*" -exec rm {} +
            fi
          done

          # ç§»é™¤æ— ç”¨æ–‡ä»¶
          rm -f patch/ModList0.4a.md
          rm -f patch/README.md
          rm -f patch/TODOlist.md
          rm -f patch/KubeJSStyleGuide.md
          rm -f patch/DevGuide.md
          rm -f patch/pack.toml
          rm -f patch/index.toml
          rm -f patch/client_jvm_args.example.txt

          # æ›´æ–°fancymenuç‰ˆæœ¬æ–‡ä»¶
          mkdir -p "patch/$VERSION_FILE_RELATIVE_DIR_PATH"
          echo "|||" > "patch/$VERSION_FILE_RELATIVE_DIR_PATH/version.md"
          echo "$MODPACK_NAME $MODPACK_VERSION" >> "patch/$VERSION_FILE_RELATIVE_DIR_PATH/version.md"
          echo "MIT License Copyright (c) 2025 CTNH Production Team" >> "patch/$VERSION_FILE_RELATIVE_DIR_PATH/version.md"
          echo "|||" >> "patch/$VERSION_FILE_RELATIVE_DIR_PATH/version.md"
          cat patch/$VERSION_FILE_RELATIVE_DIR_PATH/version.md

      - name: ç”Ÿæˆlinuxè„šæœ¬
        run: |
          cat << 'EOF' > deploy-patch.sh
          #!/bin/bash
          echo "Applying Patch..."
          BASE_DIR=$(dirname "$(readlink -f "$0")")

          # files to be deleted
          if [ -f "$BASE_DIR/deleted_files.txt" ]; then
            while IFS= read -r line; do
              file_path="$BASE_DIR/$line"
              if [ -f "$file_path" ]; then
                rm -v "$file_path" || { echo "Error: Cannot delete $file_path"; exit 1; }
              else
                echo "Error: File $file_path not found for deletion"
              fi
            done < "$BASE_DIR/deleted_files.txt"
          else
            echo "Error: $BASE_DIR/deleted_files.txt not found"
          fi

          # move patched files to right place
          if [ -d "patch" ]; then
            cp -r "patch" "." || { echo "Error: Failed to copy 'patch' directory"; exit 1; }
          else
            echo "Error: 'patch' directory not found"
          fi

          # remove patch folder
          if [ -d "patch" ]; then
            rm -rf "patch" || { echo "Error: Failed to remove 'patch' directory"; exit 1; }
            rm -rf "deleted_files.txt" || { echo "Error: Failed to remove 'deleted_files.txt'"; exit 1; }
          else
            echo "Error: 'patch' directory not found for removal"
          fi

          echo -e "\nDone!"

          EOF

      - name: ç”Ÿæˆwindowsè„šæœ¬
        run: |
          cat << 'EOF' > deploy-patch.bat
          @echo off
          setlocal enabledelayedexpansion
          chcp 65001

          rem files to be deleted
          set "pathFile=deleted_files.txt"

          rem Check if the file exists
          if not exist "%pathFile%" (
              echo File %pathFile% doesn't exist.
              exit /b 1
          )

          rem read line by line and remove files
          for /f "usebackq delims=" %%a in ("%pathFile%") do (
              rem Convert Linux-style to Windows-style path
              set "path=%%a"
              set "path=!path:/=\!"
              
              rem Check if file exists and delete it
              if exist "!path!" (
                  echo Deleting: !path!
                  del "!path!"
                  if errorlevel 1 (
                      echo Error when delete !path!
                  )
              ) else (
                  echo File !path! doesn't exist.
              )
          )

          rem move patched files to right place
          %SystemRoot%\System32\xcopy /E /I /Y "patch" "."
          rd /S /Q "patch"
          rd deleted_files.txt

          endlocal
          EOF
      - name: ä¸Šä¼ æœåŠ¡å™¨è¡¥ä¸
        uses: actions/upload-artifact@v4
        with:
          name: "[ServerPatch]${{ env.MODPACK_NAME }}-${{ env.LATEST_TAG }}-to-${{ env.MODPACK_VERSION }}"
          path: |
            deleted_files.txt
            deploy-patch.sh
            deploy-patch.bat
            patch/
      - name: æ£€æµ‹å¹¶ç”Ÿæˆmods metaä¿¡æ¯ï¼ˆpackwizå°†ä¼šè‡ªåŠ¨ç§»é™¤cfå¯ä¸‹è½½modï¼‰
        run: |
          ./packwiz curseforge detect
      - name: æ›´æ–°index
        run: |
          ./packwiz refresh
      - name: ä¸‹è½½manifest.json
        uses: actions/download-artifact@v4
        with:
          name: "${{ env.MODPACK_NAME }}-${{ env.MODPACK_VERSION }}-manifest"
      - name: æ›´æ–°patchä¸­çš„modï¼Œå¹¶åŠ å…¥manifest.json
        run: |
          rm -rf patch/mods
          mv mods patch
          rm -rf patch/mods/*.pw.toml
          mv manifest.json patch
      - name: ä¸Šä¼ å®¢æˆ·ç«¯è¡¥ä¸
        uses: actions/upload-artifact@v4
        with:
          name: "[ClientPatch]${{ env.MODPACK_NAME }}-${{ env.LATEST_TAG }}-to-${{ env.MODPACK_VERSION }}"
          path: |
            deleted_files.txt
            deploy-patch.sh
            deploy-patch.bat
            patch/
